# 7.1.1 ICMPv4 Messages
The purpose of these messages is to provide feedback about issues related to the processing of IP packets under certain conditions, not to make IP reliable. ICMP messages are not required and are often not allowed within a network for security reasons.
CMP is available for both IPv4 and IPv6. ICMPv4 is the messaging protocol for IPv4. ICMPv6 provides these same services for IPv6 but includes additional functionality. In this course, the term ICMP will be used when referring to both ICMPv4 and ICMPv6.

The types of ICMP messages and the reasons why they are sent, are extensive. We will discuss some of the more common messages.

ICMP messages common to both ICMPv4 and ICMPv6 include:

- Host confirmation
- Destination or Service Unreachable
- Time exceeded
- Route redirection

These are some of the Destination Unreachable codes for ICMPv4:

- **0** - Net unreachable
- **1** - Host unreachable
- **2** - Protocol unreachable
- **3** - Port unreachable

**Note:** ICMPv6 has similar but slightly different codes for Destination Unreachable messages.

# 7.1.2 ICMPv6 RS and RA Messages
The informational and error messages found in ICMPv6 are very similar to the control and error messages implemented by ICMPv4. However, ICMPv6 has new features and improved functionality not found in ICMPv4. ICMPv6 messages are encapsulated in IPv6.

ICMPv6 includes four new protocols as part of the Neighbor Discovery Protocol (ND or NDP).

Messaging between an IPv6 router and an IPv6 device:

- Router Solicitation (RS) message
- Router Advertisement (RA) message

Messaging between IPv6 devices:

- Neighbor Solicitation (NS) message
- Neighbor Advertisement (NA) message
### Router Solicitation
1. RA messages are sent by routers to provide addressing information to hosts using Stateless Address Autoconfiguration (SLAAC). The RA message can include addressing information for the host such as the prefix, prefix length, DNS address, and domain name. A router will send an RA message periodically or in response to an RS message. A host using SLAAC will set its default gateway to the link-local address of the router that sent the RA.
2. When a host is configured to obtain its addressing information automatically using SLAAC, the host will send an RS message to the router requesting an RA message.
### Address Resolution
1. NS messages are sent when a device knows the IPv6 address of a device but does not know its MAC address. This is equivalent to an ARP Request for IPv4.
2. NA messages are sent in response to an NS message and match the target IPv6 address in the NS. The NA message includes the deviceâ€™s Ethernet MAC address. This is equivalent to an ARP Reply in IPv4.
### Duplicate Address Detection (DAD)
When a device is assigned a global unicast or link-local unicast address, it is recommended that DAD is performed on the address to ensure that it is unique. To check the uniqueness of an address, the device will send an NS message with its own IPv6 address as the targeted IPv6 address, shown in the figure. If another device on the network has this address, it will respond with an NA message. This NA message will notify the sending device that the address is in use. If a corresponding NA message is not returned within a certain period of time, the unicast address is unique and acceptable for use.

**Note:** DAD is not required, but RFC 4861 recommends that DAD is performed on unicast addresses.